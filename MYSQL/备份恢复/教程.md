# 数据库1
`192.168.10.19   33306   root  nvxdb123456`
/var/lib/mysql/
```shell
docker run -d -p 33306:3306 \
-v /dhf/conf/:/etc/mysql/conf.d \
-v /dhf/data:/var/lib/mysql \
-e MYSQL_ROOT_PASSWORD=nvxdb123456 \
--name test_mysql  \
mysql:5.7.40
```
```shell
docker run -d -p 33306:3306 \
-v /dhf/conf/my.cnf:/etc/my.cnf \
-v /dhf/data:/var/lib/mysql \
-e MYSQL_ROOT_PASSWORD=nvxdb123456 \
--name test_mysql  \
mysql:5.7.40
```

# 数据库2
`192.168.10.3  3306  root  nvxdb123456`

https://zhuanlan.zhihu.com/p/323722709
https://www.dqzboy.com/1346.html
`docker install perconer`
https://cloud.tencent.com/developer/article/1748436
https://blog.csdn.net/xujiamin0022016/article/details/124062340


# 安装percona（宿主机模式）
- https://learnku.com/articles/71780
- 第一步
```shell
wget https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.4/binary/redhat/7/x86_64/percona-xtrabackup-24-2.4.26-1.el7.x86_64.rpm
```
- 第二步
```shell
yum localinstall -y percona-xtrabackup-24-2.4.26-1.el7.x86_64.rpm
```

# 安装percona（容器模式）
```shell
docker run -it --rm --name percona-xtrabackup \
  -v /root/dhf/mysql5.7/data:/var/lib/mysql \
  -v ${PWD}:/backup \
  f763180872/xtrabackup \
  /bin/bash -c \
  'innobackupex \
  -H 192.168.10.45 \
  -P 22306 \
  -u root \
  -p 123456 \
  --compress \
  --compress-threads=8 \
  --stream=xbstream /tmp > /backup/stg-mysql57-backups-20220928.xb'
```

# innobackupex 用法
## 宿主机模式
```shell
# 执行全量备份
innobackupex \
--defaults-file=/dhf/conf/my.cnf \
--socket=/dhf/data/mysql.sock \
--compress \
--compress-threads=8 \
--user=root \
--password=nvxdb123456 \
/dhf/dump/compress_$(date +%Y-%m-%d)
```
## 容器模式
```shell
# 执行全量备份
docker run -it --rm --name percona-xtrabackup \
  -v /root/dhf/mysql5.7/data:/var/lib/mysql \
  -v ${PWD}:/backup \
  f763180872/xtrabackup \
  /bin/bash -c \
  'innobackupex \
  -H 192.168.10.45 \
  -P 22306 \
  -u root \
  -p 123456 \
  --compress \
  --compress-threads=8 \
  --stream=xbstream /tmp > /backup/stg-mysql57-backups-20220928.xb'
```